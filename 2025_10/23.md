# 2025年10月23日(木)

# やったこと📝

- [プラクティス lsコマンドを作る3（Reスキル） \| FBC](https://bootcamp.fjord.jp/practices/324)
- [プラクティス nginx で VirtualHost を使って 1 つのサーバーで複数のサイトを立ち上げる（Reスキル） \| FBC](https://bootcamp.fjord.jp/practices/331)
  - [nginxのバーチャルサーバ \(バーチャルホスト\) の設定を理解するまでのメモ \#VirtualHost \- Qiita](https://qiita.com/keitean/items/cbb6829e58a896564a9f)

# わかったこと💡

## lsコマンドを作る3
:::details lsコマンドを作る3
```ruby
opt.on('-a') { params[:a] = true }
opt.on('-r') { params[:r] = true }
opt.parse(ARGV)

# 中略
def fetch_dir_contents(params)
  flags = params[:a] ? File::FNM_DOTMATCH : 0
  file.list = Dir.glob('*', flags)
  file_list.reverse! if params[:r]
  file_list
end
```
:::
[Q&A: 「\-aオプションは実装しなくてよい」の意味について \| FBC](https://bootcamp.fjord.jp/questions/1779)

上記質問にて、`-a`オプションは削除しても残してもいいとのことだと理解できましたので、一緒に入れようと思います！ただ、今後色んなオプションの実装がある中で拡張性があるコードかどうかという点で疑問は残るところですが、まだ後のプラクティスを見ていないため、見てから考えようと思います！

## Array#reverse
> reverse は自身の要素を逆順に並べた新しい配列を生成して返します。 reverse! は自身を破壊的に並べ替えます。 reverse! は self を返します。

私の書いたコードだと`reverse`では上手く動作せず、`reverse!`だと動作したのでなぜだろうと思ったのですが、`reverse`は新しい配列を生成し、新しい配列を返すのに比べ、`reverse!`は自身を破壊的に変更するとあるので、変更後の配列をそのまま返しているからなんですね！

こういう細かいところが理解できていなくて思ったようにコードが動いてくれないんですね…！

ちなみに`reverse!`は配列が変化しなかった時に`nil`を返すようなので少し危険な気がしますし、できれば`reverse`を使いたいですが、新しい配列を返すようなコードにすると変数名がいっぱい増えてしまって綺麗ではないような気もします。何が綺麗なコードかはまだわかっていないのですが…

## Object#then
> self を引数としてブロックを評価し、ブロックの結果を返します。
[Object\#then \(Ruby 3\.4 リファレンスマニュアル\)](https://docs.ruby-lang.org/ja/latest/method/Object/i/then.html)

:::details 修正案
```ruby
def fetch_dir_contents(params)
  flags = params[:a] ? File::FNM_DOTMATCH : 0
  Dir.glob('*', flags).then { |list| params[:r] ? list.reverse : list }
end
```
:::

## nginx

`nginx.conf`にて
debian公式バージョンなら`/etc/nginx/nginx.conf`に配置されているのかな…？
→ありました！！
```ruby
	# Virtual Host Configs
	##

	include /etc/nginx/conf.d/*.conf;
	include /etc/nginx/sites-enabled/*;
}

```
コメントアウトされている`# Virtual Host Configs`が気になるところですね。

[Debian 12 Bookworm : Nginx : バーチャルホストの設定 : Server World](https://www.server-world.info/query?os=Debian_12&p=nginx&f=2)

上記サイトは`debian12`と`nginx`なので参考になりそうです。

## Virtual Hostについて

`Virtual Host`が、1台のサーバーで複数のwebサイトを動かす仕組みであることは理解していたつもりだったのですが、ネームベースのVirtual Hostというのは、同じIPアドレスで2つの異なるドメインを運営できるという仕組みになるようで、1つのIPアドレスは1つのサイトしか開けないと思っていたので驚きでした。

ブラウザがサーバーにアクセスするときに、サーバーはHTTPリクエスト内のHostヘッダーを見て、どのサイトを返すか判別しているそうです。

# 次にやること✅

- [プラクティス lsコマンドを作る3（Reスキル） \| FBC](https://bootcamp.fjord.jp/practices/324)
- [プラクティス nginx で VirtualHost を使って 1 つのサーバーで複数のサイトを立ち上げる（Reスキル） \| FBC](https://bootcamp.fjord.jp/practices/331)

# いまの気持ち🫶

なんとかlsコマンドを作る3の方は明日提出できそうです！

# 学習時間

- 3時間(合計: 605時間30分)
