# 2025å¹´9æœˆ21æ—¥(æ—¥)

# ã‚„ã£ãŸã“ã¨ğŸ“

- [ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä¿®æ­£ï¼ˆãƒªãƒãƒ¼ã‚·ç·¨ï¼‰ï¼ˆReã‚¹ã‚­ãƒ«ï¼‰ \| FBC](https://bootcamp.fjord.jp/practices/321)
  - [å†å¸°å‡¦ç†ã¨ã¯ï½œã€Œåˆ†ã‹ã‚Šãã†ã€ã§ã€Œåˆ†ã‹ã‚‰ãªã„ã€ã§ã‚‚ã€Œåˆ†ã‹ã£ãŸã€æ°—ã«ãªã‚Œã‚‹ITç”¨èªè¾å…¸](https://wa3.i-3-i.info/word14899.html)
# ã‚ã‹ã£ãŸã“ã¨ğŸ’¡
## ç½®ã‘ãªã„å ´æ‰€ã«ç½®ã‘ã‚‹åˆ¤å®šãŒå‡ºã‚‹å•é¡Œ

:::details put_stoneãƒ¡ã‚½ãƒƒãƒ‰ã®å†…å®¹
```ruby
# ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  1) Failure:
ReversiMethodsTest#test_cannot_put_stone [test/reversi_methods_test.rb:73]:
Expected true to not be truthy.

# å®Ÿè¡Œã—ãŸãƒ¡ã‚½ãƒƒãƒ‰
def test_cannot_put_stone
    initial_data = <<~BOARD
      W-WWWW--  # ã“ã®B1ã«é»’çŸ³ãŒç½®ã‘ã‚‹ã¨ã„ã†åˆ¤å®šã«ãªã£ã¦ã„ã‚‹
      W-BWWW--
      WBWWWWW-
      WWBWWW--
      WBBBBB--
      --B-----
      --B-----
      --B-----
    BOARD
    board = build_board(initial_data)
    refute put_stone(board, 'b1', BLACK_STONE)ã€€# ã‚¨ãƒ©ãƒ¼åˆ¤å®šã•ã‚ŒãŸã®ã¯ã“ã®è¡Œ
    assert_equal build_board(initial_data), board
  end
```

ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸè¡Œã§`put_stone`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã®ã§ã€ã¾ãšã¯`put_stone`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç¢ºèªã—ã¾ã™ã€‚

```ruby
def put_stone(board, cell_ref, stone_color, dry_run: false)
    pos = Position.new(cell_ref)
    raise 'ç„¡åŠ¹ãªãƒã‚¸ã‚·ãƒ§ãƒ³ã§ã™' if pos.invalid?
    raise 'ã™ã§ã«çŸ³ãŒç½®ã‹ã‚Œã¦ã„ã¾ã™' unless pos.stone_color(board) == BLANK_CELL

    # ã‚³ãƒ”ãƒ¼ã—ãŸç›¤é¢ã«ã¦çŸ³ã®é…ç½®ã‚’è©¦ã¿ã¦ã€æˆåŠŸã™ã‚Œã°åæ˜ ã™ã‚‹
    copied_board = Marshal.load(Marshal.dump(board))
    copied_board[pos.row][pos.col] = stone_color

    turn_succeed = false
    Position::DIRECTIONS.each do |direction|
      next_pos = pos.next_position(direction)
      turn_succeed = true if turn(copied_board, next_pos, stone_color, direction)
    end

    copy_board(board, copied_board) if !dry_run && turn_succeed

    turn_succeed
  end
```
ã¾ãšã€ç›¤ä¸Šå¤–ã‚„ç„¡åŠ¹ãªå€¤ã®å ´åˆã‚„ç©ºç™½ã§ã¯ãªã„å ´åˆã«ã¯ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã¦å³çµ‚äº†ã™ã‚‹ä»•çµ„ã¿ã§ã™ãŒã€ä»Šå›ã¯`b1`ã¨ã„ã†æœ‰åŠ¹ã‹ã¤ç©ºç™½ã®ãƒã‚¹ã®ãŸã‚ã‚³ãƒ¼ãƒ‰ãŒå…ˆã¸é€²ã¿ã¾ã™ã€‚

æ¬¡ã«ã‚³ãƒ”ãƒ¼ã—ãŸç›¤é¢ã‚’ä½œã‚Šã€ã‚³ãƒ”ãƒ¼ä¸Šã®æŒ‡å®šãƒã‚¹ã«çŸ³ã‚’ç½®ãã¾ã™ã€‚

`turn_succeed`ã¨ã„ã†å¤‰æ•°ã‚’ä½œã‚Šã€`false`ã¨ã„ã†å€¤ã§åˆæœŸåŒ–ã—ã¾ã™ã€‚

- ãƒ«ãƒ¼ãƒ—å‡¦ç†
  - 8æ–¹å‘ã‚’é †ã«å–ã‚Šå‡ºã—ã¦ãƒ«ãƒ¼ãƒ—å‡¦ç†ã‚’å§‹ã‚ã€çŸ³ã‚’ç½®ã“ã†ã¨ã—ã¦ã„ã‚‹ãƒã‚¹ï¼ˆ= posï¼‰ã‹ã‚‰ã€direction æ–¹å‘ã« 1 ãƒã‚¹é€²ã‚“ã ä½ç½®ã‚’next_posã«ä»£å…¥ã—ã¾ã™ã€‚

  - ã©ã®æ–¹å‘ã‹1ã¤ã§ã‚‚è£è¿”ã›ã‚Œã°`turn_succeed`ã‚’`true`ã«ã—ã¾ã™ã€‚

ã‚³ãƒ”ãƒ¼ã®ç›¤é¢ã§ã¯ãªãã€ã‹ã¤ã©ã‚Œã‹ä¸€æ–¹å‘ã§ã‚‚ã²ã£ãã‚Šè¿”ã›ãŸå ´åˆã«ã‚³ãƒ”ãƒ¼ç›¤é¢ã‚’æœ¬ç‰©ã®ç›¤é¢ã«åæ˜ ã—ã¾ã™ã€‚

æœ€å¾Œã«ã²ã£ãã‚Šè¿”ã›ãŸã¨ãã¯trueã€è¿”ã›ãªã‹ã£ãŸå ´åˆã¯falseã‚’è¿”ã—ã¦çµ‚äº†ã—ã¾ã™ã€‚
:::

# æ¬¡ã«ã‚„ã‚‹ã“ã¨

- [ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä¿®æ­£ï¼ˆãƒªãƒãƒ¼ã‚·ç·¨ï¼‰ï¼ˆReã‚¹ã‚­ãƒ«ï¼‰ \| FBC](https://bootcamp.fjord.jp/practices/321)

# ã„ã¾ã®æ°—æŒã¡ğŸ«¶
`put_stone`ãƒ¡ã‚½ãƒƒãƒ‰ãŒæœ¬å½“ã«ä½•ã‚’ã‚„ã£ã¦ã‚‹ã®ã‹å…¨ãç†è§£ã§ããªãã¦æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã—ãŸãŒã€ãªã‚“ã¨ã‹å†å°±æ¥­ã¾ã§è§£é‡ˆã§ããŸæ°—ãŒã™ã‚‹ã®ã§ã¨ã‚Šã‚ãˆãšã‚ˆã‹ã£ãŸã§ã™ã€‚

# å­¦ç¿’æ™‚é–“

- 3æ™‚é–“30åˆ†(åˆè¨ˆ: 548æ™‚é–“45åˆ†)
